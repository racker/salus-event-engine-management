stream
  |from()
    .measurement('measurement')
    .groupBy('resourceId')
  |where(lambda:
    if(isPresent("resource_metadata.os"), "resource_metadata.os" == 'linux', FALSE)
      AND
    if(isPresent("resource_metadata.env"), "resource_metadata.env" == 'prod', FALSE)
      )
  |alert()
    .stateChangesOnly()
    .id('tenant:{{index .Tags "system_resourceId"}}:measurement:field')
    .details('task={{.TaskName}}')
    .crit(lambda: "field" >= 33)
    .topic('events')